# 词典数据导入指南

## 系统架构

StarSpeak 使用统一的词典数据库架构，支持：
- ✅ 多个词典来源（ECDICT、word_translation 等）
- ✅ AI 生成的单词自动保存
- ✅ 按优先级查询
- ✅ 离线查词 / AI查词 模式切换

## 准备工作

### 1. 安装 Python 依赖

```bash
pip install -r scripts/requirements.txt
```

## 导入脚本

### 1. Word Translation 词典（推荐先导入）

**文件格式**：CSV 或 TSV
```
单词,中文翻译
或
单词\t中文翻译
```

**使用方法**：
```bash
# 将 word_translation.csv 放在项目根目录
python scripts/import_word_translation.py
```

**特点**：
- 自动检测分隔符（逗号或Tab）
- 支持高中、考研、托福等词汇
- 快速导入

### 2. ECDICT 完整词典（可选）

**文件格式**：CSV（多列格式）

**使用方法**：
```bash
python scripts/import_dictionary.py
```

**特点**：
- 76 万词条
- 包含音标、词频、考试标签等
- 导入时间较长（30-60分钟）

## 功能说明

### AI查词模式
1. 先查询本地历史
2. 查询所有词典数据库（按优先级）
3. 查不到才调用 AI
4. **AI 结果自动保存到数据库**
5. 下次查询相同单词直接返回，无需再调用 AI

### 离线查词模式
1. 仅查询本地历史
2. 仅查询词典数据库
3. **不调用 AI**（节省流量和费用）

## 词典优先级

系统按以下顺序查询：
1. 本地历史记录（最快）
2. ECDICT（优先级 10）
3. word_translation（优先级 20）
4. AI生成内容（优先级 100）

## 注意事项

⚠️ **重要提示：**

1. **建议先导入 word_translation**：数据量小，导入快
2. **AI结果自动保存**：查过的单词会自动保存，下次离线可用
3. **可随时中断**：已导入的数据会保留
4. **支持重复运行**：重复的单词会自动跳过

## 常见问题

### Q: 我应该导入哪个词典？
A: 建议先导入 word_translation（快速，覆盖常用词），ECDICT 可选。

### Q: AI 查询的单词会保存吗？
A: 会！AI 查询结果会自动保存到数据库，下次离线查询时直接返回。

### Q: 如何查看导入了多少单词？
A: 脚本结束时会显示统计信息。

## 下一步

导入完成后，在前端可以：
- 切换 AI查词 / 离线查词 模式
- 享受快速的词典查询
- AI 查询的结果会自动积累到数据库
